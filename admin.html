<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <script>
        window.onerror = function(msg, url, line, col, error) {
            console.error('Global Error:', msg, url, line, col, error);
            // alert('Error: ' + msg + '\nLine: ' + line); // Optional: Alert user
            return false;
        };
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุชุญูู ุงููุธุงู | Olayan Admin</title>
    <link rel="stylesheet" href="style-admin.css?v=6">
    <link rel="icon" type="image/svg+xml" href="olayan-mark.svg">
    <!-- SheetJS for Excel Import -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js" defer></script>
    <!-- app.js is needed for data fetching logic if we want to sync with board data -->
    <script src="app.js?v=7" defer></script>
    <style>
        /* Toast Notification System */
        #toast-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .toast {
            background: rgba(15, 23, 42, 0.95);
            color: #fff;
            padding: 12px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Tajawal', sans-serif;
            border: 1px solid rgba(255,255,255,0.1);
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            min-width: 320px;
            backdrop-filter: blur(10px);
            pointer-events: auto;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast-icon {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 14px;
            flex-shrink: 0;
        }

        .toast-success .toast-icon { background: #10b981; color: #fff; }
        .toast-error .toast-icon { background: #ef4444; color: #fff; }
        .toast-info .toast-icon { background: #3b82f6; color: #fff; }
        
        .toast-content {
            flex: 1;
        }
        
        .toast-title {
            font-weight: bold;
            font-size: 0.95rem;
            margin-bottom: 2px;
            color: #fff;
        }
        
        .toast-message {
            font-size: 0.85rem;
            color: #94a3b8;
        }
    </style>
</head>
<body class="admin-body ar">
    <div id="toast-container"></div>
    
    <!-- LOGIN SCREEN -->
    <div id="login-section" class="login-wrapper">
        <div class="login-box">
            <img src="olayan-logo.png" alt="Olayan Logo" class="login-logo">
            <h2 id="login-title" class="login-title">Admin Login</h2>
            
            <div class="form-group">
                <label id="lbl-user" for="username">Username</label>
                <input type="text" id="username" class="form-control" placeholder="Enter Username">
            </div>
            
            <div class="form-group">
                <label id="lbl-pass" for="pin">Password</label>
                <div style="position: relative;">
                    <input type="password" id="pin" class="form-control" placeholder="Enter Password">
                    <span id="toggle-password" class="eye-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </span>
                </div>
            </div>
            
            <button id="login" class="btn btn-primary" style="width: 100%;">Sign In</button>
            
            <a href="#" class="forgot-pass" id="forgot-pass-link">Forgot Password?</a>

            <p id="msg" style="margin-top: 20px; color: var(--danger); font-size: 0.9rem;"></p>

            <div class="lang-switch" style="margin-top: 25px; display: flex; justify-content: center; gap: 10px;">
                <button class="btn btn-glass" id="login-lang-en" style="font-size: 0.8rem; padding: 6px 15px; border-radius: 20px;">English</button>
                <button class="btn btn-glass" id="login-lang-ar" style="font-size: 0.8rem; padding: 6px 15px; border-radius: 20px;">ุงูุนุฑุจูุฉ</button>
            </div>
        </div>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div id="admin-content" class="admin-layout" style="display: none; width: 100%;">
        <div class="sidebar-overlay" onclick="toggleAdminSidebar()"></div>
        
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <img src="olayan-logo.png" class="sidebar-logo" alt="Logo">
                <span class="sidebar-brand">ููุญุฉ ุงูุชุญูู</span>
            </div>
            <nav class="sidebar-nav">
                <!-- Group 1: Leadership -->
                <div class="nav-group active" id="group-leadership">
                    <div class="nav-group-header" onclick="toggleSidebarGroup('group-leadership')">
                        <span>๐ ุงูููุงุฏุฉ ูุงูุชุญููู</span>
                        <i class="arrow-icon">โผ</i>
                    </div>
                    <div class="nav-group-content">
                        <a href="#" onclick="showSection('dashboard'); return false;" class="nav-item active" id="nav-dashboard">
                            <i>๐</i> ุงูุฑุฆูุณูุฉ
                        </a>
                        <a href="#" onclick="showSection('analytics'); return false;" class="nav-item" id="nav-analytics">
                            <i>๐ง</i> ุงูุชุญููู ุงูุงุณุชุฑุงุชูุฌู (AI)
                        </a>
                        <a href="#" onclick="showSection('tasks'); return false;" class="nav-item" id="nav-tasks">
                            <i>โ</i> ุงูููุงู
                        </a>
                    </div>
                </div>

                <!-- Group 2: Data Management -->
                <div class="nav-group" id="group-data">
                    <div class="nav-group-header" onclick="toggleSidebarGroup('group-data')">
                        <span>๐ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช</span>
                        <i class="arrow-icon">โถ</i>
                    </div>
                    <div class="nav-group-content" style="display:none;">
                        <a href="#" onclick="showSection('master-upload'); return false;" class="nav-item" id="nav-master-upload">
                            <i>๐พ</i> ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช (Master)
                        </a>
                        <a href="#" onclick="showSection('employees'); return false;" class="nav-item" id="nav-employees">
                            <i>๐ฅ</i> ุงูููุธููู
                        </a>
                        <a href="#" onclick="showSection('violations'); return false;" class="nav-item" id="nav-violations">
                            <i>โ๏ธ</i> ุงููุฎุงููุงุช
                        </a>
                        <a href="training.html" target="_blank" class="nav-item" id="nav-training">
                            <i>๐</i> ุงูุชุฏุฑูุจ
                        </a>
                        <a href="#" onclick="showSection('branches'); return false;" class="nav-item" id="nav-branches">
                            <i>๐ฌ</i> ุงููุฑูุน
                        </a>
                        <!-- Fixed: Use internal section for Licenses -->
                        <a href="#" onclick="showSection('licenses'); return false;" class="nav-item" id="nav-licenses">
                            <i>๐</i> ุงูุชุฑุงุฎูุต
                        </a>
                        <a href="#" onclick="showSection('advanced-data'); return false;" class="nav-item" id="nav-advanced-data">
                            <i>๐พ</i> ุงูุจูุงูุงุช ุงููุชูุฏูุฉ
                        </a>
                    </div>
                </div>

                <!-- Group 3: Users & Services -->
                <div class="nav-group" id="group-users">
                    <div class="nav-group-header" onclick="toggleSidebarGroup('group-users')">
                        <span>๐ฅ ุงููุณุชุฎุฏููู ูุงูุดูุงูู</span>
                        <i class="arrow-icon">โถ</i>
                    </div>
                    <div class="nav-group-content" style="display:none;">
                        <a href="#" onclick="showSection('users'); return false;" class="nav-item" id="nav-users">
                            <i>๐ค</i> ุงูุฃุนุถุงุก
                        </a>
                        <a href="#" onclick="showSection('services'); return false;" class="nav-item" id="nav-services">
                            <i>๐ฉ</i> ุงูุดูุงูู ูุงูุทูุจุงุช
                        </a>
                    </div>
                </div>

                <!-- Group: Quick Access (New) -->
                <div class="nav-group" id="group-access">
                    <div class="nav-group-header" onclick="toggleSidebarGroup('group-access')">
                        <span>๐ ูุตูู ุณุฑูุน</span>
                        <i class="arrow-icon">โถ</i>
                    </div>
                    <div class="nav-group-content" style="display:none;">
                        <a href="index.html" target="_blank" class="nav-item">
                            <i>๐</i> ุงููููุน ุงูุฑุฆูุณู (Public)
                        </a>
                        <a href="login.html" target="_blank" class="nav-item">
                            <i>๐</i> ุฏุฎูู ุงูููุธููู
                        </a>
                        <a href="board.html" target="_blank" class="nav-item">
                            <i>๐</i> ุชูุฑูุฑ ุงูุฅุฏุงุฑุฉ (Public)
                        </a>
                    </div>
                </div>

                <!-- Group 4: System (Collapsed to hide clutter) -->
                <div class="nav-group" id="group-system">
                    <div class="nav-group-header" onclick="toggleSidebarGroup('group-system')">
                        <span>โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุธุงู</span>
                        <i class="arrow-icon">โถ</i>
                    </div>
                    <div class="nav-group-content" style="display:none;">
                        <div onclick="showSection('settings'); return false;" class="nav-item" id="nav-settings">
                            <i>โ๏ธ</i> ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ
                        </div>
                        <div onclick="showSection('media'); return false;" class="nav-item" id="nav-media">
                            <i>๐ผ๏ธ</i> ุงููุณุงุฆุท
                        </div>
                        <div onclick="showSection('pages'); return false;" class="nav-item" id="nav-pages">
                            <i>๐</i> ุงูุตูุญุงุช
                        </div>
                        <div onclick="showSection('comments'); return false;" class="nav-item" id="nav-comments">
                            <i>๐ฌ</i> ุงูุชุนูููุงุช
                        </div>
                        <div onclick="showSection('appearance'); return false;" class="nav-item" id="nav-appearance">
                            <i>๐จ</i> ุงููุธูุฑ
                        </div>
                        <div onclick="showSection('plugins'); return false;" class="nav-item" id="nav-plugins">
                            <i>๐งฉ</i> ุงูุฅุถุงูุงุช
                        </div>
                        <div onclick="showSection('tools'); return false;" class="nav-item" id="nav-tools">
                            <i>๐๏ธ</i> ุงูุฃุฏูุงุช
                        </div>
                        <div onclick="showSection('email'); return false;" class="nav-item" id="nav-email">
                            <i>โ๏ธ</i> ุงูุจุฑูุฏ
                        </div>
                    </div>
                </div>

                <div style="border-top: 1px solid rgba(255,255,255,0.1); margin: 15px 20px;"></div>
                
                <a href="board.html" target="_blank" class="nav-item" style="margin: 0 10px;">
                    <i>๐</i> ุงูุฐูุงุจ ูููููุน
                </a>
            </nav>
            <div style="padding: 20px;">
                <button id="logout" class="btn btn-danger" style="width: 100%; justify-content: center;">ุชุณุฌูู ุฎุฑูุฌ</button>
            </div>
            <div class="sidebar-footer" style="padding: 10px 20px; text-align: center; font-size: 0.7rem; color: #64748b; border-top: 1px solid #eee;">
                <div style="margin-bottom: 5px;">ุฌููุน ุงูุญููู ูุญููุธุฉ ูุฏู ุดุฑูุฉ ุงูุนููุงู ููุฎุฏูุงุช ุงูุบุฐุงุฆูุฉ ยฉ 2025</div>
                <div style="direction: ltr;">Developed by Bandar A. Abdulwahab</div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <button id="sidebar-toggle" class="btn btn-secondary" style="margin-inline-end: 10px; display: none;">โฐ</button>
                <div class="header-title" id="page-title">ููุฎุต ุงููุธุงู</div>
                <div class="header-actions">
                    <!-- Status Indicators (Moved to Header) -->
                    <div id="merge-mode-indicator" class="status-pill">
                        <span class="status-dot"></span>
                        <span class="status-text">ูุถุน ุงูุฏูุฌ: ุชุญุฏูุซ ููุท</span>
                    </div>
                    <div id="update-source-indicator" class="status-pill">
                        <span class="status-icon">๐</span>
                        <span class="status-text">ุขุฎุฑ ุชุญุฏูุซ: Excel</span>
                    </div>

                    <!-- Language Switcher -->
                    <div class="lang-toggle">
                        <button class="btn-icon-text active" id="btn-lang-ar">ุนุฑุจู</button>
                        <span class="divider">|</span>
                        <button class="btn-icon-text" id="btn-lang-en">En</button>
                    </div>

                    <!-- Data Control Trigger -->
                    <div style="position:relative;">
                        <button class="btn btn-glass" id="btn-control-menu" title="ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช">
                            <i>๐พ</i>
                            <span>ุงูุจูุงูุงุช</span>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div id="control-menu" class="control-menu-dropdown">
                            
                            <div class="menu-actions-grid">
                                <button class="menu-action-btn" onclick="document.getElementById('excel-employees-file').click()">
                                    <i>๐ฅ</i> ุชุญุฏูุซ ุงูููุธููู (Excel)
                                </button>
                                <button class="menu-action-btn" onclick="document.getElementById('excel-violations-file').click()">
                                    <i>โ๏ธ</i> ุชุญุฏูุซ ุงููุฎุงููุงุช (Excel)
                                </button>
                                <button class="menu-action-btn" onclick="exportEmployeesToExcel()">
                                    <i>๐</i> ุชุตุฏูุฑ ุงูููุธููู (Excel)
                                </button>
                                <button class="menu-action-btn" onclick="exportViolationsToExcel()">
                                    <i>๐</i> ุชุตุฏูุฑ ุงููุฎุงููุงุช (Excel)
                                </button>
                            </div>

                            <div class="merge-controls">
                                <span class="lbl-merge">ูุถุน ุงูุฏูุฌ:</span>
                                <div class="toggle-group">
                                    <button class="toggle-btn active" id="btn-mode-merge">ุชุญุฏูุซ</button>
                                    <button class="toggle-btn" id="btn-mode-replace">ุงุณุชุจุฏุงู</button>
                                </div>
                            </div>
                            
                            <!-- Hidden File Inputs -->
                            <input type="file" id="excel-employees-file" accept=".xlsx, .xls, .csv" style="display:none;">
                            <input type="file" id="excel-violations-file" accept=".xlsx, .xls, .csv" style="display:none;">

                            <div class="dev-note">
                                <small>ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ โข Eng. Bandar A. Abdulwahab</small>
                            </div>
                        </div>
                    </div>

                    <!-- User Profile -->
                    <div class="user-profile">
                        <div class="user-info">
                            <div class="user-name" id="admin-user-name">Bandar A.</div>
                            <div class="user-role">ูุณุคูู ุงููุธุงู</div>
                        </div>
                        <div class="user-avatar">B</div>
                    </div>
                </div>
            </header>

            <div class="admin-content-wrapper">
                
                <!-- SECTION: MASTER DATA UPLOAD (NEW) -->
                <div id="section-master-upload" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ุงููุฑูุฒูุฉ (Master Data)</span>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 96, 0.1)); border: 1px solid rgba(79,172,254,0.2); padding: 30px; border-radius: 16px; margin-bottom: 30px; text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: 15px;">๐</div>
                            <h3 style="margin-top: 0; color: #fff;">ุงูุฑูุน ุงูููุญุฏ (Master Excel)</h3>
                            <p style="color: #94a3b8; font-size: 1rem; max-width: 600px; margin: 0 auto 20px auto;">
                                ูู ุจุฑูุน ููู Excel ูุงุญุฏ ูุญุชูู ุนูู ุนุฏุฉ ูุฑูุงุช (Sheets) ูุชุญุฏูุซ ุงููุธุงู ุจุงููุงูู ุชููุงุฆูุงู.
                                <br>
                                <span style="font-size: 0.85rem; color: #4facfe;">(Licenses, Violations, Employees)</span>
                            </p>
                            
                            <input type="file" id="master-excel-upload" multiple accept=".xlsx, .xls, .csv" style="display: none;">
                            <button class="btn btn-primary" onclick="document.getElementById('master-excel-upload').click()" style="padding: 12px 30px; font-size: 1.1rem; border-radius: 50px; background: linear-gradient(90deg, #4facfe, #00f260); border: none;">
                                ๐ ุฑูุน ูููุงุช ูุชุนุฏุฏุฉ (Smart Upload)
                            </button>
                            <div id="master-upload-status" style="margin-top: 15px; font-weight: bold; color: #f59e0b;"></div>
                            
                            <div style="margin-top: 20px; text-align: left;">
                                <h4 style="margin: 0 0 10px 0; color: #fff;">ุงููููุงุช ุงููุฑููุนุฉ</h4>
                                <div id="upload-files-list" style="display: flex; flex-direction: column; gap: 8px;"></div>
                            </div>
                        </div>

                        <!-- Manual Violations Editor -->
                        <div class="section-header">
                            <span class="section-title">ุชุนุฏูู ุงููุฎุงููุงุช ูุฏููุงู</span>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="vio-search" placeholder="ุจุญุซ ูู ุงููุฎุงููุงุช..." class="form-control" style="width: 200px;">
                                <button class="btn btn-danger" onclick="clearViolationsData()">๐๏ธ ูุณุญ ุงููู</button>
                            </div>
                        </div>
                        
                        <div style="overflow-x: auto; max-height: 600px; border: 1px solid #334155; border-radius: 8px;">
                            <table class="data-table" style="width: 100%;">
                                <thead style="position: sticky; top: 0; background: #0f172a; z-index: 10;">
                                    <tr>
                                        <th>ุงููุฑุน</th>
                                        <th>ุงูููุทูุฉ</th>
                                        <th>ููุน ุงููุฎุงููุฉ</th>
                                        <th>ุงููุจูุบ</th>
                                        <th>ุงูุชุงุฑูุฎ</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="violations-editor-body">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                        <div id="vio-pagination" style="margin-top: 15px; color: #94a3b8; font-size: 0.9rem;"></div>

                    </div>
                </div>

                <!-- SECTION: DASHBOARD -->
                <div id="section-dashboard">
                    <!-- Welcome Header -->
                    <div class="dashboard-v2-header">
                        <div class="dash-welcome">
                            <h2>ูุฑุญุจุงูุ <span style="color: #4facfe;">Bandar</span> ๐</h2>
                            <p>ุฅููู ููุฎุต ุฃุฏุงุก ุงููุธุงู ุงููููุ ูุฏูู 3 ููุงู ุฌุฏูุฏุฉ.</p>
                        </div>
                        <div class="dash-date" style="text-align: left; opacity: 0.8;">
                            <h3 style="margin:0; font-size:1.5rem;">31</h3>
                            <span style="font-size:0.9rem;">December, 2025</span>
                        </div>
                    </div>

                    <!-- AI Command Bar (New) -->
                    <div class="ai-command-bar">
                        <div class="ai-input-wrapper">
                            <span class="ai-icon">โจ</span>
                            <input type="text" id="ai-command-input" placeholder="ุงุทูุจ ูู ุงููุณุงุนุฏ ุงูุฐูู... (ูุซุงู: 'ุฃุธูุฑ ุงููุฑูุน ุงูุฃูุซุฑ ูุฎุงููุงุช'ุ 'ุงูุชุฑุญ ุฎุทุฉ ุชุฏุฑูุจ')">
                            <button class="btn-ai-send" onclick="processAICommand()">ุฅุฑุณุงู</button>
                        </div>
                    </div>

                    <!-- Key Metrics -->
                    <div class="dash-metrics-row">
                        <div class="dash-metric-card">
                            <div class="dm-icon" style="color:#4facfe;">๐ฅ</div>
                            <div class="dm-info">
                                <h4>ุงููุณุชุฎุฏููู ุงููุดุทูู</h4>
                                <span class="dm-val" id="stat-users">3</span>
                            </div>
                        </div>
                        <div class="dash-metric-card">
                            <div class="dm-icon" style="color:#a18cd1;">๐</div>
                            <div class="dm-info">
                                <h4>ุงูููุงู ุงูููุชููุฉ</h4>
                                <span class="dm-val">85%</span>
                            </div>
                        </div>
                        <div class="dash-metric-card">
                            <div class="dm-icon" style="color:#ffb74d;">๐ฉ</div>
                            <div class="dm-info">
                                <h4>ุงูุดูุงูู ุงูุฌุฏูุฏุฉ</h4>
                                <span class="dm-val" id="stat-complaints">12</span>
                            </div>
                        </div>
                        <div class="dash-metric-card">
                            <div class="dm-icon" style="color:#00f260;">โ</div>
                            <div class="dm-info">
                                <h4>ุญุงูุฉ ุงููุธุงู</h4>
                                <span class="dm-val" style="color:#00f260;">98%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Split View: Goals & Tasks -->
                    <div class="dash-grid-split">
                        
                        <!-- Right Column (In RTL): Performance & Goals -->
                        <div class="dash-panel">
                            <div class="dash-panel-header">
                                <span class="dash-panel-title"><i>๐ฏ</i> ุงูุฃูุฏุงู ูุงูุชูุฏู (Goals)</span>
                                <button class="btn btn-secondary" style="padding: 4px 10px; font-size: 0.8rem;">ุชุญุฏูุซ</button>
                            </div>
                            
                            <!-- Efficiency Circle -->
                            <div class="efficiency-chart">
                                <div class="circle-chart" style="--p: 85deg;">
                                    <div class="circle-inner">
                                        <span class="circle-val">85%</span>
                                        <span class="circle-lbl">ุงูููุงุกุฉ</span>
                                    </div>
                                </div>
                                <div class="circle-chart" style="--p: 62deg; --c: #a18cd1;">
                                    <div class="circle-inner">
                                        <span class="circle-val">62%</span>
                                        <span class="circle-lbl">ุงูุฅูุฌุงุฒ</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Goals Bars -->
                             <div style="margin-top: 20px;">
                                 <div class="goal-item">
                                     <div class="goal-header">
                                         <span>ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู</span>
                                         <span>75%</span>
                                     </div>
                                     <div class="goal-progress"><div class="goal-fill" style="width: 75%; background: linear-gradient(90deg, #4facfe, #00f260);"></div></div>
                                 </div>
                                 <div class="goal-item">
                                     <div class="goal-header">
                                         <span>ูุนุงูุฌุฉ ุงูุดูุงูู</span>
                                         <span>90%</span>
                                     </div>
                                     <div class="goal-progress"><div class="goal-fill" style="width: 90%; background: linear-gradient(90deg, #f093fb, #f5576c);"></div></div>
                                 </div>
                                 <div class="goal-item">
                                     <div class="goal-header">
                                         <span>ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช</span>
                                         <span>40%</span>
                                     </div>
                                     <div class="goal-progress"><div class="goal-fill" style="width: 40%; background: linear-gradient(90deg, #43e97b, #38f9d7);"></div></div>
                                 </div>
                             </div>
                        </div>

                        <!-- Left Column: Tasks -->
                        <div class="dash-panel">
                            <div class="dash-panel-header">
                                <span class="dash-panel-title"><i>๐</i> ููุงู ุงูููู (Tasks)</span>
                                <a href="tasks.html" style="color: #4facfe; font-size: 0.85rem;">ุนุฑุถ ุงููู</a>
                            </div>
                            
                            <div class="task-list">
                                <div class="task-item">
                                    <div class="task-info">
                                        <div class="task-check completed"></div>
                                        <div>
                                            <div class="task-text">ูุฑุงุฌุนุฉ ุชูุฑูุฑ ุงููุจูุนุงุช</div>
                                            <div style="font-size: 0.75rem; color: #64748b;">10:00 AM</div>
                                        </div>
                                    </div>
                                    <span class="task-tag">High</span>
                                </div>
                                <div class="task-item">
                                    <div class="task-info">
                                        <div class="task-check"></div>
                                        <div>
                                            <div class="task-text">ุชุญุฏูุซ ุจูุงูุงุช ุงูููุธููู</div>
                                            <div style="font-size: 0.75rem; color: #64748b;">02:00 PM</div>
                                        </div>
                                    </div>
                                    <span class="task-tag">Medium</span>
                                </div>
                                <div class="task-item">
                                    <div class="task-info">
                                        <div class="task-check"></div>
                                        <div>
                                            <div class="task-text">ุงุฌุชูุงุน ุงููุฑูู ุงูุชููู</div>
                                            <div style="font-size: 0.75rem; color: #64748b;">04:30 PM</div>
                                        </div>
                                    </div>
                                    <span class="task-tag">Low</span>
                                </div>
                                <div class="task-item">
                                    <div class="task-info">
                                        <div class="task-check completed"></div>
                                        <div>
                                            <div class="task-text">ูุณุฎ ุงุญุชูุงุทู ูููุธุงู</div>
                                            <div style="font-size: 0.75rem; color: #64748b;">09:00 AM</div>
                                        </div>
                                    </div>
                                    <span class="task-tag">Auto</span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- AI Analysis -->
                <div id="section-analytics" class="content-section d-none">
                    <div class="section-header">
                        <span class="section-title">ุงูุชุญููู ุงูุงุณุชุฑุงุชูุฌู (AI)</span>
                        <div style="display:flex; gap:10px;">
                            <select id="ai-year-filter" class="form-control" style="width:150px;">
                                <option value="all">ูู ุงูุณููุงุช</option>
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                            </select>
                            <button class="btn btn-primary" onclick="generateStrategicReport()">๐ ุชุญุฏูุซ ุงูุชุญููู</button>
                        </div>
                    </div>

                    <!-- AI Insights Cards -->
                    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:20px; margin-bottom:30px;">
                        
                        <!-- Insight 1: Operational Efficiency -->
                        <div class="stat-card" style="border-right: 4px solid #10b981;">
                            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                                <h3 style="color:#10b981; margin:0;">ุงูููุงุกุฉ ุงูุชุดุบูููุฉ</h3>
                                <span style="font-size:1.5rem;">โ๏ธ</span>
                            </div>
                            <p id="ai-insight-ops" style="color:#cbd5e1; line-height:1.6; font-size:0.9rem;">
                                ุฌุงุฑู ุงูุชุญููู...
                            </p>
                        </div>

                        <!-- Insight 2: Financial Risk -->
                        <div class="stat-card" style="border-right: 4px solid #ef4444;">
                            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                                <h3 style="color:#ef4444; margin:0;">ุงููุฎุงุทุฑ ุงููุงููุฉ</h3>
                                <span style="font-size:1.5rem;">๐</span>
                            </div>
                            <p id="ai-insight-risk" style="color:#cbd5e1; line-height:1.6; font-size:0.9rem;">
                                ุฌุงุฑู ุงูุชุญููู...
                            </p>
                        </div>

                        <!-- Insight 3: Workforce Stability -->
                        <div class="stat-card" style="border-right: 4px solid #3b82f6;">
                            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                                <h3 style="color:#3b82f6; margin:0;">ุงุณุชูุฑุงุฑ ุงูููู ุงูุนุงููุฉ</h3>
                                <span style="font-size:1.5rem;">๐ฅ</span>
                            </div>
                            <p id="ai-insight-hr" style="color:#cbd5e1; line-height:1.6; font-size:1rem;">
                                ุฌุงุฑู ุงูุชุญููู...
                            </p>
                        </div>

                        <!-- Insight 4: Actionable Recommendation -->
                        <div class="stat-card" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.05) 100%); border:1px solid rgba(245, 158, 11, 0.3);">
                            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                                <h3 style="color:#fbbf24; margin:0;">๐ก ุชูุตูุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู</h3>
                            </div>
                            <p id="ai-recommendation" style="color:#fff; font-weight:bold; line-height:1.6; font-size:1rem;">
                                ุฌุงุฑู ุจูุงุก ุงูุชูุตูุงุช...
                            </p>
                        </div>
                    </div>

                    <div style="display:grid; grid-template-columns: 2fr 1fr; gap:20px;">
                        <!-- Chart 1: Violations Heatmap/Map -->
                        <div class="stat-card">
                            <h3>๐ ุฎุงุฑุทุฉ ุงููุฎุงุทุฑ (Violations by City/Region)</h3>
                            <p style="color:#aaa; font-size:0.8rem; margin-bottom:15px;">ุชูุฒูุน ุงููุฎุงููุงุช ุญุณุจ ุงููุฏู ูุงูููุงุทู ุงูุฃูุซุฑ ุชุถุฑุฑุงู</p>
                            <div id="chart-ai-risk-map" style="height: 300px;"></div>
                        </div>

                        <!-- Chart 2: Trend Analysis -->
                        <div class="stat-card">
                            <h3>๐ ุงุชุฌุงู ุงููุฎุงููุงุช (Trend)</h3>
                            <p style="color:#aaa; font-size:0.8rem; margin-bottom:15px;">ุชุญููู ููุท ุงููุฎุงููุงุช ุงูุฒููู</p>
                            <div id="chart-ai-trend" style="height: 300px;"></div>
                        </div>
                    </div>
                    
                    <div style="margin-top:20px;">
                        <div class="stat-card">
                             <h3>๐จ ุฃุนูู ุงููุฑูุน ุชูุฑุงุฑุงู ูููุฎุงููุงุช (Top Repeat Offenders)</h3>
                             <div id="ai-top-offenders-table" style="overflow-x:auto;">
                                 <!-- Table Populated by JS -->
                             </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION: MEDIA -->
                <div id="section-media" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ูุณุงุฆุท</span>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: PAGES -->
                <div id="section-pages" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุตูุญุงุช</span>
                            <button class="btn btn-primary">ุตูุญุฉ ุฌุฏูุฏุฉ +</button>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: BRANCHES -->
                <div id="section-branches" class="d-none">
                    <div class="card-section">
                        <div class="section-header" style="display:flex; justify-content:space-between; align-items:center;">
                            <span class="section-title" id="branches-title">ุฅุฏุงุฑุฉ ุงููุฑูุน ูุงูู KPIs</span>
                            <a href="branches.html" target="_blank" class="btn btn-secondary" id="btn-open-branches">ูุชุญ ุตูุญุฉ ุงููุฑูุน โ</a>
                        </div>

                        <!-- Section Toggle -->
                        <div class="section-toggle" onclick="toggleSectionContent('branches-content', this)" style="cursor:pointer; display:flex; align-items:center; gap:5px; margin-bottom:15px; user-select:none;">
                            <span class="toggle-icon" style="transition:transform 0.3s;">โผ</span>
                            <span style="font-weight:bold; color:#4facfe;">ุนุฑุถ/ุฅุฎูุงุก ุงูุชูุงุตูู</span>
                        </div>

                        <div id="branches-content" style="transition:all 0.3s ease-out; overflow:hidden;">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                                <div>
                                    <label id="lbl-branch-name" style="display:block; color:#666; font-size:0.85rem;">ุงุณู ุงููุฑุน</label>
                                    <input id="br-name" class="form-control" type="text">
                                </div>
                                <div>
                                    <label id="lbl-branch-type" style="display:block; color:#666; font-size:0.85rem;">ุงูููุน</label>
                                    <select id="br-type" class="form-control">
                                        <option value="basic" id="opt-type-basic">ุฃุณุงุณู</option>
                                        <option value="opening" id="opt-type-opening">ุงูุชุชุงุญ</option>
                                    </select>
                                </div>
                                <div>
                                    <label id="lbl-branch-brand" style="display:block; color:#666; font-size:0.85rem;">ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ</label>
                                    <input id="br-brand" class="form-control" type="text" placeholder="BK / TC / BWW">
                                </div>
                                <div>
                                    <label id="lbl-branch-email" style="display:block; color:#666; font-size:0.85rem;">ุงูุงูููู</label>
                                    <input id="br-email" class="form-control" type="email">
                                </div>
                                <div>
                                    <label id="lbl-branch-cost" style="display:block; color:#666; font-size:0.85rem;">Cost Center</label>
                                    <input id="br-cost" class="form-control" type="text">
                                </div>
                                <div>
                                    <label id="lbl-branch-ops" style="display:block; color:#666; font-size:0.85rem;">OPS1</label>
                                    <input id="br-ops" class="form-control" type="text">
                                </div>
                                <div>
                                    <label id="lbl-branch-logo" style="display:block; color:#666; font-size:0.85rem;">ุดุนุงุฑ ุงูุนูุงูุฉ</label>
                                    <input id="br-logo" class="form-control" type="file" accept="image/*">
                                </div>
                                <div>
                                    <label id="lbl-branch-kpi-target" style="display:block; color:#666; font-size:0.85rem;">ูุฏู KPI</label>
                                    <input id="br-kpi-target" class="form-control" type="number" step="0.01">
                                </div>
                                <div>
                                    <label id="lbl-branch-kpi-value" style="display:block; color:#666; font-size:0.85rem;">ูููุฉ KPI</label>
                                    <input id="br-kpi-value" class="form-control" type="number" step="0.01">
                                </div>
                            </div>
                            <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
                                <button class="btn btn-primary" id="btn-branch-save">ุญูุธ ุงููุฑุน</button>
                                <button class="btn btn-secondary" id="btn-branch-new">ูุฑุน ุฌุฏูุฏ</button>
                                <button class="btn btn-secondary" id="btn-branch-export">ุชุตุฏูุฑ JSON</button>
                                <input type="file" id="br-json-file" accept="application/json" style="display:none;">
                                <button class="btn btn-secondary" id="btn-branch-import">ุงุณุชูุฑุงุฏ JSON</button>
                                <button class="btn btn-secondary" id="btn-branch-import-text">ุงุณุชูุฑุงุฏ ูู ูุต</button>
                            </div>
                            <div style="margin-top:8px;">
                                <label style="display:block; color:#666; font-size:0.85rem;">ูุตู ูุงุฆูุฉ (ุงูุงุณู TAB ูุฑูุฒ ุงูุชูููุฉ TAB ุงูุงูููู)</label>
                                <textarea id="br-bulk-text" class="form-control" rows="4" placeholder="ุงูุงุณู\t6120... - BK - ูุฑุน\tbk.example@olayanfood.com"></textarea>
                            </div>
                            <div style="margin-top:16px; overflow:auto;">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>ุงุณู ุงููุฑุน</th>
                                            <th>ุงูููุน</th>
                                            <th>ุงูุนูุงูุฉ</th>
                                            <th>ุงูุงูููู</th>
                                            <th>Cost Center</th>
                                            <th>OPS1</th>
                                            <th>KPI%</th>
                                            <th>ุงูุดุนุงุฑ</th>
                                            <th>ุงูุญุงูุฉ</th>
                                            <th>ุฅุฌุฑุงุกุงุช</th>
                                        </tr>
                                    </thead>
                                    <tbody id="branches-table-body"></tbody>
                                </table>
                            </div>
                            <div id="br-count-total" style="margin-top: 20px; text-align: left; color: #94a3b8; font-size: 0.9rem;">
                                ุฅุฌูุงูู ุงููุฑูุน: 0
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION: VIOLATIONS -->
                <div id="section-violations" class="d-none">
                    <div class="card-section">
                        <div class="section-header" style="display:flex; justify-content:space-between; align-items:center;">
                            <span class="section-title" id="violations-title">ุฅุฏุงุฑุฉ ุงููุฎุงููุงุช</span>
                            <a href="violations.html" target="_blank" class="btn btn-secondary">ูุชุญ ููุญุฉ ุงููุฎุงููุงุช โ</a>
                        </div>
                        
                        <!-- Section Toggle -->
                        <div class="section-toggle" onclick="toggleSectionContent('violations-content', this)" style="cursor:pointer; display:flex; align-items:center; gap:5px; margin-bottom:15px; user-select:none;">
                            <span class="toggle-icon" style="transition:transform 0.3s;">โผ</span>
                            <span style="font-weight:bold; color:#4facfe;">ุนุฑุถ/ุฅุฎูุงุก ุงูุชูุงุตูู</span>
                        </div>

                        <div id="violations-content" style="transition:all 0.3s ease-out; overflow:hidden;">
                            <!-- Column Toggle for Violations -->
                            <div class="column-toggle-wrapper" style="margin-bottom: 15px; position: relative;">
                                <button class="btn btn-secondary" onclick="toggleColumnMenu('vio-col-menu')" style="display: flex; align-items: center; gap: 5px;">
                                    <span>๐๏ธ ุฅุธูุงุฑ/ุฅุฎูุงุก ุงูุฃุนูุฏุฉ</span>
                                    <span style="font-size: 0.8em;">โผ</span>
                                </button>
                                <div id="vio-col-menu" class="column-menu" style="display: none; position: absolute; top: 100%; right: 0; background: #1e293b; border: 1px solid #334155; border-radius: 8px; padding: 10px; z-index: 100; min-width: 200px; box-shadow: 0 4px 6px rgba(0,0,0,0.3);">
                                    <!-- Checkboxes will be injected here via JS -->
                                </div>
                            </div>

                            <div style="background: rgba(79,172,254,0.05); border: 1px solid rgba(79,172,254,0.2); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                                <h4 style="margin-top: 0; color: #4facfe;">ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช (Excel / CSV)</h4>
                                <p style="color: #666; font-size: 0.9rem; margin-bottom: 15px;">
                                    ูู ุจุฑูุน ููู Excel ูุญุชูู ุนูู ุจูุงูุงุช ุงููุฎุงููุงุช. ุงููุธุงู ุณูููู ุชููุงุฆูุงู ุจุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช (ุงูุฅุฌูุงููุ ุงููุจุงูุบุ ุงูููุงุทูุ ุงูุฃูุซุฑ ุชูุฑุงุฑุงู).
                                </p>
                                <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                                    <input type="file" id="vio-excel-file" accept=".xlsx, .xls, .csv" style="display: none;">
                                    <button class="btn btn-primary" onclick="document.getElementById('vio-excel-file').click()">๐ ุฑูุน ููู Excel</button>
                                    <span id="vio-file-name" style="color: #666; font-size: 0.9rem;"></span>
                                </div>
                                <div style="margin-top: 15px; font-size: 0.85rem; color: #888;">
                                    <strong>ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ (ุงูุชุฑุชูุจ ุบูุฑ ูููุ ุงุจุญุซ ุนู ุงูุฃุณูุงุก):</strong><br>
                                    Branch (ุงููุฑุน), Region (ุงูููุทูุฉ), Violation (ุงููุฎุงููุฉ), Amount (ุงูุบุฑุงูุฉ), Status (ุงูุญุงูุฉ: Open/Closed), Date (ุงูุชุงุฑูุฎ)
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <!-- JSON Management -->
                                <div style="border: 1px solid #eee; padding: 15px; border-radius: 8px;">
                                    <h4 style="margin-top: 0; color: #555;">ุฅุฏุงุฑุฉ ููู JSON</h4>
                                    <div style="display: flex; flex-direction: column; gap: 10px;">
                                        <button class="btn btn-secondary" onclick="document.getElementById('vio-json-file').click()">ุงุณุชูุฑุงุฏ JSON ุฌุงูุฒ</button>
                                        <input type="file" id="vio-json-file" accept=".json" style="display: none;">
                                        
                                        <button class="btn btn-secondary" onclick="downloadViolationsJSON()">ุชุตุฏูุฑ ุงูุจูุงูุงุช ุงูุญุงููุฉ (JSON)</button>
                                        <button class="btn btn-danger" onclick="clearViolationsData()">๐๏ธ ูุณุญ ุฌููุน ุงูุจูุงูุงุช</button>
                                    </div>
                                </div>

                                <!-- Current Stats Preview -->
                                <div style="border: 1px solid #eee; padding: 15px; border-radius: 8px;">
                                    <h4 style="margin-top: 0; color: #555;">ุญุงูุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ</h4>
                                    <div id="vio-stats-preview" style="font-size: 0.9rem; color: #333;">
                                        ุฌุงุฑู ุงูุชุญููู...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- SECTION: COMMENTS -->
                <div id="section-comments" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุชุนูููุงุช</span>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: APPEARANCE -->
                <div id="section-appearance" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ูุธูุฑ</span>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: PLUGINS -->
                <div id="section-plugins" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุฅุถุงูุงุช</span>
                            <button class="btn btn-primary">ุฅุถุงูุฉ ุฌุฏูุฏุฉ +</button>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: TOOLS -->
                <div id="section-tools" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุฃุฏูุงุช</span>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: SETTINGS -->
                <div id="section-settings" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุงูุฅุนุฏุงุฏุงุช</span>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: EMAIL -->
                <div id="section-email" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุงูููู</span>
                        </div>
                        <p class="dev-badge" data-en="Coming soon โ Site under development โข Engineer (Bandar A.Abdullwahab)" data-ar="ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)" style="display:inline-block; background: rgba(79,172,254,0.12); border:1px solid #4facfe; color:#4facfe; padding:6px 10px; border-radius:12px;">ูุฑุงูู ูุฑูุจุงู โ ุฌุงุฑู ุงูุชุทููุฑ ุนูู ุงููููุน โข ุงููููุฏุณ (Bandar A.Abdullwahab)</p>
                    </div>
                </div>

                <!-- SECTION: USERS -->
                <div id="section-users" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุงูุฃุนุถุงุก</span>
                            <button onclick="openAddUserModal()" class="btn btn-primary">ุฅุถุงูุฉ ูุณุชุฎุฏู +</button>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ุงุณู ุงููุณุชุฎุฏู</th>
                                    <th>ุงูุตูุงุญูุฉ</th>
                                    <th>ุชุงุฑูุฎ ุงูุฅุถุงูุฉ</th>
                                    <th>ุฅุฌุฑุงุกุงุช</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body">
                                <!-- Users will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- SECTION: EMPLOYEES -->
                <div id="section-employees" class="d-none">
                    <div class="card-section" style="background: #1e293b; color: white; border: 1px solid #334155;">
                        <div class="section-header" style="border-bottom: 1px solid #334155;">
                            <span class="section-title" style="color: #60a5fa;">ุณุฌู ุงูููุธููู ุงูุดุงูู</span>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="emp-search" placeholder="ุจุญุซ (ุงูุงุณูุ ุงููููุฉุ ุงููุฑุน)..." class="form-control" style="width: 250px; background: #0f172a; border: 1px solid #334155; color: white;">
                                <button onclick="generateRandomEmployees()" class="btn btn-secondary">๐ ุชูููุฏ ุจูุงูุงุช</button>
                                <button onclick="exportEmployees()" class="btn btn-primary">๐ ุชุตุฏูุฑ Excel</button>
                            </div>
                        </div>
                        
                        <div style="overflow-x: auto; margin-top: 15px;">
                            <!-- Column Toggle for Employees -->
                            <div class="column-toggle-wrapper" style="margin-bottom: 15px; position: relative;">
                                <button class="btn btn-secondary" onclick="toggleColumnMenu('emp-col-menu')" style="display: flex; align-items: center; gap: 5px;">
                                    <span>๐๏ธ ุฅุธูุงุฑ/ุฅุฎูุงุก ุงูุฃุนูุฏุฉ</span>
                                    <span style="font-size: 0.8em;">โผ</span>
                                </button>
                                <div id="emp-col-menu" class="column-menu" style="display: none; position: absolute; top: 100%; right: 0; background: #1e293b; border: 1px solid #334155; border-radius: 8px; padding: 10px; z-index: 100; min-width: 200px; box-shadow: 0 4px 6px rgba(0,0,0,0.3);">
                                    <!-- Checkboxes will be injected here via JS -->
                                </div>
                            </div>

                            <table class="data-table" id="employees-table" style="width: 100%; min-width: 1000px;">
                                <thead>
                                    <tr style="background: #0f172a;">
                                        <th id="th-emp" data-col="emp">ุงูููุธู</th>
                                        <th id="th-iqama" data-col="iqama">ุฑูู ุงููููุฉ/ุงูุฅูุงูุฉ</th>
                                        <th id="th-brand" data-col="brand">ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ</th>
                                        <th id="th-branch" data-col="branch">ุงููุฑุน</th>
                                        <th id="th-region" data-col="region">ุงูููุทูุฉ</th>
                                        <th id="th-health" data-col="health">ุงูุดูุงุฏุฉ ุงูุตุญูุฉ</th>
                                        <th id="th-training" data-col="training">ุญุงูุฉ ุงูุชุฏุฑูุจ</th>
                                        <th id="th-view" data-col="view">ุนุฑุถ</th>
                                    </tr>
                                </thead>
                                <tbody id="employees-table-body">
                                    <!-- Dynamic Content -->
                                </tbody>
                            </table>
                        </div>
                        <div id="emp-pagination" style="margin-top: 20px; display:flex; justify-content:space-between; align-items:center; color: #94a3b8; font-size: 0.9rem;">
                            <div id="emp-count-total">ุฅุฌูุงูู ุงูุนุฏุฏ: 0</div>
                            <div id="emp-page-info">ุนุฑุถ 0 ูู ุฃุตู 0 ููุธู</div>
                        </div>
                    </div>
                </div>

                <!-- SECTION: CMS -->
                <div id="section-cms" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุชุนุฏูู ุจูุงูุงุช ุงูููุญุฉ (CMS)</span>
                            <div>
                                <button onclick="saveCMSData()" class="btn btn-primary">ุญูุธ ุงูุชุบููุฑุงุช</button>
                                <button onclick="resetCMSData()" class="btn btn-secondary">ุงุณุชุนุงุฏุฉ ุงูุงูุชุฑุงุถู</button>
                            </div>
                        </div>
                        <p id="save-msg" style="margin-bottom: 20px; color: var(--primary-color); font-weight: bold;"></p>

                        <div class="form-grid">
                            <!-- KPIs -->
                            <div style="border: 1px solid #eee; padding: 15px; border-radius: 8px;">
                                <h4 style="margin-top: 0; color: var(--secondary-color);">ุงููุคุดุฑุงุช ุงูุฑุฆูุณูุฉ (KPIs)</h4>
                                <div class="form-group">
                                    <label>ROI (ุงูุนุงุฆุฏ)</label>
                                    <input type="text" id="cms-roi" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Effectiveness (ุงูููุงุกุฉ)</label>
                                    <input type="text" id="cms-eff" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Risks (ุงููุฎุงุทุฑ)</label>
                                    <input type="text" id="cms-risk" class="form-control">
                                </div>
                            </div>

                            <!-- Projects -->
                            <div style="border: 1px solid #eee; padding: 15px; border-radius: 8px;">
                                <h4 style="margin-top: 0; color: var(--secondary-color);">ุงูุฃุฏุงุก ุงููุชููุน (Projects)</h4>
                                <div class="form-group">
                                    <label>Strengths (ููุงุท ุงูููุฉ)</label>
                                    <input type="text" id="cms-proj-strength" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Weaknesses (ููุงุท ุงูุถุนู)</label>
                                    <input type="text" id="cms-proj-weak" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Goal (ุงููุฏู)</label>
                                    <input type="text" id="cms-proj-goal" class="form-control">
                                </div>
                            </div>

                            <!-- Regions -->
                            <div style="border: 1px solid #eee; padding: 15px; border-radius: 8px;">
                                <h4 style="margin-top: 0; color: var(--secondary-color);">ุฃุฏุงุก ุงูุชุดุบูู (Regional)</h4>
                                <div class="form-group">
                                    <label>Western (ุงูุบุฑุจูุฉ)</label>
                                    <input type="text" id="cms-reg-west" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Central (ุงููุณุทู)</label>
                                    <input type="text" id="cms-reg-cen" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Eastern (ุงูุดุฑููุฉ)</label>
                                    <input type="text" id="cms-reg-east" class="form-control">
                                </div>
                            </div>

                            <!-- Depts -->
                            <div style="border: 1px solid #eee; padding: 15px; border-radius: 8px;">
                                <h4 style="margin-top: 0; color: var(--secondary-color);">ุฃุฏุงุก ุงูุฃูุณุงู (Depts)</h4>
                                <div class="form-group">
                                    <label>IT (ุงูุชูููุฉ)</label>
                                    <input type="text" id="cms-dept-it" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Finance (ุงููุงููุฉ)</label>
                                    <input type="text" id="cms-dept-fin" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Maintenance (ุงูุตูุงูุฉ)</label>
                                    <input type="text" id="cms-dept-maint" class="form-control">
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
                            <h4 style="color: var(--secondary-color);">ุงููุดุฑ ูููููุน ุงูุญู (GitHub)</h4>
                            <p style="font-size: 0.85rem; color: #777; margin-bottom: 10px;">
                                ูุฐุง ุงูุฎูุงุฑ ูููู ุจุชุญุฏูุซ <strong>ุงูุฃุฑูุงู ูุงูุจูุงูุงุช ููุท</strong> (ููู JSON) ูู ุงููููุน ุงูุญู.
                                ูุชุญุฏูุซ ุงูุชุตููู ูุงูุจุฑูุฌุฉุ ุงุณุชุฎุฏู ุงูููู <code>deploy.ps1</code> ุงููุฑูู.
                            </p>
                            <div style="display: flex; gap: 10px; align-items: flex-end;">
                                <div style="flex: 1;">
                                    <label style="font-size: 0.8rem; color: #777;">GitHub Token</label>
                                    <input type="password" id="gh-token" class="form-control" placeholder="ghp_xxxxxxxxxxxx">
                                    <small><a href="https://github.com/settings/tokens?type=beta" target="_blank" style="color: #6f42c1; text-decoration: underline;">ุฅูุดุงุก ุชููู ุฌุฏูุฏ (Generate Token) โ</a></small>
                                </div>
                                <button onclick="saveTokenAndPublish()" class="btn btn-primary" style="background-color: #6f42c1;">ุชุญุฏูุซ ุงูุจูุงูุงุช (Data Sync) ๐</button>
                            </div>
                            <div id="merge-mode-cms" style="margin-top: 12px; display:flex; gap:8px; align-items:center;">
                                <span id="lbl-merge-mode-cms" style="color:#333; font-size:0.9rem;">ูุถุน ุงูุฏูุฌ:</span>
                                <button class="btn btn-secondary" id="btn-mode-merge-cms">ุชุญุฏูุซ ููุท</button>
                                <button class="btn btn-secondary" id="btn-mode-replace-cms">ุงุณุชุจุฏุงู ูุงูู</button>
                            </div>
                            <div style="margin-top:8px; color:#555; font-size:0.85rem;">
                                <div id="desc-merge-update">ุชุญุฏูุซ ููุท: ุฏูุฌ ุฐูู ูุญุงูุธ ุนูู ุงูููุฌูุฏ ููุญุฏูุซ ุงูููู ููุถูู ุงูุฌุฏูุฏ.</div>
                                <div id="desc-merge-replace" style="margin-top:4px;">ุงุณุชุจุฏุงู ูุงูู: ูุณุชุจุฏู ุงููุงุฆูุฉ ุจุงููุงูู ุจุงููุตุฏุฑ ุงููุงุฏู.</div>
                                <div id="desc-merge-sources" style="margin-top:6px; color:#333;">ูุตุงุฏุฑ ุงูุชุญุฏูุซ: Excelุ JSON ูู GitHubุ JSON ูุญููุ ุชุนุฏูู ูุฏูู ุนุจุฑ ุงูููุญุฉ.</div>
                            </div>
                            <div id="update-time-settings" style="margin-top:12px; padding:10px; border:1px solid #eee; border-radius:8px; display:flex; gap:16px; align-items:flex-end; flex-wrap:wrap;">
                                <div style="display:flex; flex-direction:column; gap:6px;">
                                    <label id="lbl-show-update-time" style="font-size:0.85rem; color:#777;">ุนุฑุถ ุงูููุช ุจุฌุงูุจ ุขุฎุฑ ุชุญุฏูุซ</label>
                                    <input type="checkbox" id="chk-show-update-time">
                                </div>
                                <div style="display:flex; flex-direction:column; gap:6px;">
                                    <label id="lbl-date-format" style="font-size:0.85rem; color:#777;">ุชูุณูู ุงูุชุงุฑูุฎ</label>
                                    <select id="sel-date-format" class="form-control" style="min-width:180px;">
                                        <option value="locale" id="opt-format-locale">ูุญูู</option>
                                        <option value="iso" id="opt-format-iso">ISO</option>
                                        <option value="relative" id="opt-format-relative">ูุณุจู</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION: SERVICES -->
                <div id="section-services" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุงูุดูุงูู ูุงูุฎุฏูุงุช</span>
                        </div>
                        
                        <!-- Complaints List -->
                        <div style="margin-bottom: 30px;">
                            <h4 style="color: var(--secondary-color);">ุตูุฏูู ุงูุดูุงูู ุงููุงุฑุฏุฉ</h4>
                            <div id="complaints-list">
                                <!-- Complaints loaded here -->
                            </div>
                        </div>

                        <!-- Services JSON Editor -->
                        <div style="border-top: 1px solid #eee; padding-top: 20px;">
                            <div class="section-header">
                                <span class="section-title" style="font-size: 1.1rem;">ุชุนุฏูู ุจูุงูุงุช ุงูุฎุฏูุงุช (JSON)</span>
                                <button onclick="saveServicesJson()" class="btn btn-primary">ุญูุธ ุงูุฎุฏูุงุช</button>
                            </div>
                            <p style="color: #666; font-size: 0.9rem;">ููุง ููููู ุชุนุฏูู ููููุฉ ุงูุฎุฏูุงุช ุงูุชู ุชุธูุฑ ูู ุตูุญุฉ ุงูุดูุงูู (ุงูุฃูุณุงูุ ุงูุฎูุงุฑุงุชุ ุฅูุฎ).</p>
                            <textarea id="services-json-editor" class="form-control" style="font-family: monospace; direction: ltr; min-height: 300px; background: #1e293b; color: #a5b4fc;"></textarea>
                        </div>
                    </div>
                </div>

                <!-- SECTION: TASKS -->
                <div id="section-tasks" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุฅุฏุงุฑุฉ ุงูููุงู</span>
                            <a href="tasks.html" target="_blank" class="btn btn-secondary">ูุชุญ ุงูููุญุฉ ุงููุงููุฉ โ</a>
                        </div>
                        
                        <!-- Task Stats -->
                        <div class="dash-metrics-row" style="margin-bottom: 20px;">
                            <div class="dash-metric-card">
                                <div class="dm-icon" style="color:#f59e0b;">โณ</div>
                                <div class="dm-info">
                                    <h4>ููุฏ ุงูุงูุชุธุงุฑ</h4>
                                    <span class="dm-val" id="admin-task-pending">0</span>
                                </div>
                            </div>
                            <div class="dash-metric-card">
                                <div class="dm-icon" style="color:#4facfe;">๐</div>
                                <div class="dm-info">
                                    <h4>ุฌุงุฑู ุงูุนูู</h4>
                                    <span class="dm-val" id="admin-task-progress">0</span>
                                </div>
                            </div>
                            <div class="dash-metric-card">
                                <div class="dm-icon" style="color:#10b981;">โ</div>
                                <div class="dm-info">
                                    <h4>ููุชููุฉ</h4>
                                    <span class="dm-val" id="admin-task-completed">0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Tasks Table -->
                        <h4 style="color: var(--secondary-color); margin-bottom: 15px;">ุขุฎุฑ ุงูููุงู ุงููุณุฌูุฉ</h4>
                        <div style="overflow-x: auto;">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>ุงูุนููุงู</th>
                                        <th>ุงูููุธู ุงููุณุคูู</th>
                                        <th>ุงูุฃููููุฉ</th>
                                        <th>ุชุงุฑูุฎ ุงูุงุณุชุญูุงู</th>
                                        <th>ุงูุญุงูุฉ</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-tasks-body">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- SECTION: LICENSES -->
                <div id="section-licenses" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุฅุฏุงุฑุฉ ุงูุชุฑุงุฎูุต ูุงูุชุตุงุฑูุญ</span>
                            <a href="licenses.html" target="_blank" class="btn btn-secondary">ูุชุญ ููุญุฉ ุงูุชุญููู โ</a>
                        </div>

                        <!-- Excel Upload -->
                        <div style="background: rgba(16, 185, 129, 0.05); border: 1px solid rgba(16, 185, 129, 0.2); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                            <h4 style="margin-top: 0; color: #10b981;">ุงุณุชูุฑุงุฏ ุจูุงูุงุช ุงูุชุฑุงุฎูุต (Excel)</h4>
                            <p style="color: #666; font-size: 0.9rem; margin-bottom: 15px;">
                                ูู ุจุฑูุน ููู Excel ูุญุชูู ุนูู ุจูุงูุงุช ุฑุฎุต ุงูุจูุฏูุฉ ูุงูุฏูุงุน ุงููุฏูู (ููุณ ุงููููู ูู ุงูุตูุฑุฉ).
                            </p>
                            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                                <input type="file" id="lic-excel-file" accept=".xlsx, .xls, .csv" style="display: none;">
                                <button class="btn btn-primary" onclick="document.getElementById('lic-excel-file').click()" style="background-color: #10b981;">๐ ุฑูุน ููู Excel</button>
                                <button class="btn btn-secondary" onclick="downloadLicensesTemplate()">โฌ๏ธ ุชุญููู ูููุฐุฌ (Template)</button>
                                <span id="lic-file-name" style="color: #666; font-size: 0.9rem;"></span>
                            </div>
                        </div>

                        <!-- Visibility Controls -->
                        <div class="section-header" style="margin-top: 30px;">
                            <span class="section-title" style="font-size: 1.1rem;">ุฅุนุฏุงุฏุงุช ุงูุนุฑุถ ูู ุงููููุน</span>
                        </div>
                        <div style="background: var(--card-bg); padding: 15px; border-radius: 8px; border: 1px solid #eee; display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <label class="switch">
                                    <input type="checkbox" id="chk-show-licenses-dashboard" onchange="toggleLicensesVisibility()">
                                    <span class="slider round"></span>
                                </label>
                                <span>ุนุฑุถ ููุญุฉ ุงูุชุฑุงุฎูุต ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ูููููุน</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <label class="switch">
                                    <input type="checkbox" id="chk-show-licenses-public" onchange="toggleLicensesVisibility()">
                                    <span class="slider round"></span>
                                </label>
                                <span>ุฅุชุงุญุฉ ุงููุตูู ุงูุนุงู (ุจุฏูู ุชุณุฌูู ุฏุฎูู)</span>
                            </div>
                        </div>

                        <!-- Data Preview & Cost Management -->
                        <div class="section-header" style="margin-top: 30px;">
                            <span class="section-title" style="font-size: 1.1rem;">ุงูุจูุงูุงุช ูุชูุงููู ุงููุฑูุน</span>
                            <div style="display:flex; gap:10px;">
                                <button onclick="openLicenseModal()" class="btn btn-success">ุฅุถุงูุฉ ุฌุฏูุฏ</button>
                                <button onclick="saveBranchCosts()" class="btn btn-primary">ุญูุธ ุงูุชูุงููู</button>
                                <button onclick="clearLicensesData()" class="btn btn-danger">ูุณุญ ุงูุจูุงูุงุช</button>
                            </div>
                        </div>
                        
                        <div style="overflow-x: auto; max-height: 500px; border: 1px solid #eee; border-radius: 8px;">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>ุงููุฑุน (Restaurant)</th>
                                        <th>ุงูุชูููุฉ (Cost)</th>
                                        <th>ุฑุฎุตุฉ ุงูุจูุฏูุฉ (Store License)</th>
                                        <th>ุงูุฏูุงุน ุงููุฏูู (Civil Defense)</th>
                                        <th>ุชุตุฑูุญ 24ุณ</th>
                                        <th>ุชุตุฑูุญ HD</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="licenses-table-body">
                                    <!-- Populated by JS -->
                                    <tr><td colspan="8" style="text-align:center; padding:20px; color:#888;">ูุง ุชูุฌุฏ ุจูุงูุงุช. ูู ุจุฑูุน ููู Excel ุฃู ุฅุถุงูุฉ ุฌุฏูุฏ.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- SECTION: ADVANCED DATA -->
                <div id="section-advanced-data" class="d-none">
                    <div class="card-section">
                        <div class="section-header">
                            <span class="section-title">ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ุงููุชูุฏูุฉ (Board Data)</span>
                            <div style="display:flex; gap:10px;">
                                <button onclick="saveBoardJson()" class="btn btn-primary">ุญูุธ ุงูุชุบููุฑุงุช</button>
                                <button onclick="formatBoardJson()" class="btn btn-secondary">ุชูุณูู JSON</button>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255,193,7,0.1); border: 1px solid #ffc107; padding: 15px; border-radius: 8px; margin-bottom: 20px; color: #856404;">
                            <strong>ุชูุจูู:</strong> ูุฐุง ุงููุญุฑุฑ ูุฎุตุต ูููุทูุฑูู ูุงููุณุชุฎุฏููู ุงููุชูุฏููู. ุฃู ุฎุทุฃ ูู ุตูุบุฉ JSON ูุฏ ูุคุฏู ุฅูู ุชุนุทู ููุญุฉ ุงูููุงุฏุฉ.
                        </div>

                        <div class="form-group">
                            <label style="display:block; margin-bottom:10px;">ุจูุงูุงุช ุงูููุญุฉ ุงูุฑุฆูุณูุฉ (Board JSON Override)</label>
                            <textarea id="board-json-editor" class="form-control" style="font-family: monospace; direction: ltr; min-height: 500px; background: #1e293b; color: #69f0ae; line-height: 1.5;"></textarea>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

            <div id="employee-modal" style="position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:9999;">
        <div style="background:#0b0e2b; color:#fff; width:92%; max-width:800px; border-radius:16px; overflow:hidden; max-height:95vh; overflow-y:auto;">
            <div id="emp-banner" style="height:120px; background:#0b0e2b;"></div>
            <div style="padding:20px;">
                <div style="display:flex; align-items:center; gap:15px; margin-top:-60px;">
                    <div style="position:relative; width:80px; height:80px;">
                        <div id="emp-avatar" style="width:80px; height:80px; border-radius:14px; background:#4facfe; color:#fff; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:1.4rem; overflow:hidden;">A</div>
                        <button id="btn-change-photo" class="btn btn-secondary" style="position:absolute; bottom:-10px; inset-inline-start:0; transform:translateY(50%); padding:2px 6px; font-size:0.7rem;">ุชุบููุฑ ุงูุตูุฑุฉ</button>
                        <input id="emp-photo" type="file" accept="image/*" style="display:none;">
                    </div>
                    <div>
                        <div id="emp-name-display" style="font-size:1.2rem; font-weight:700;"></div>
                        <div style="display: flex; gap: 10px; align-items: center; margin-top: 4px;">
                            <div id="emp-role-display" style="color:#4facfe; font-size:0.9rem; font-weight:bold;"></div>
                            <div id="emp-id-display" style="color:#94a3b8; font-size:0.8rem; background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 4px;"></div>
                        </div>
                    </div>
                </div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:20px;">
                    <div>
                        <label id="lbl-sap" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">SAP ID</label>
                        <input id="emp-sap" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-ref" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">REF#</label>
                        <input id="emp-ref" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-iqama" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">ID#</label>
                        <input id="emp-iqama" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-name" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Name</label>
                        <input id="emp-name" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-phone" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Phone Number</label>
                        <input id="emp-phone" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div style="grid-column: span 2;">
                        <label style="display:inline-flex; align-items:center; gap:8px; cursor:pointer; color:#b0bec5; font-size:0.8rem; margin-bottom:5px;">
                            <input type="checkbox" id="chk-iqama-img" style="width:14px; height:14px;">
                            <span>Upload ID/Iqama Image (ุตูุฑุฉ ุงููููุฉ/ุงูุฅูุงูุฉ)</span>
                        </label>
                        <div id="div-iqama-img" style="display:none; margin-top:5px;">
                            <input id="emp-iqama-file" type="file" accept="image/*" class="form-control" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px; font-size:0.8rem;">
                            <div id="view-iqama-img" style="margin-top:5px;"></div>
                        </div>
                    </div>
                    <div>
                        <label id="lbl-band" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Band</label>
                        <input id="emp-band" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-cost" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Cost center</label>
                        <input id="emp-cost" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-ops1" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Ops</label>
                        <input id="emp-ops1" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-hire" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Hire date</label>
                        <input id="emp-hire" class="form-control" type="date" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-tede" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">T. E. D.E</label>
                        <input id="emp-tede" class="form-control" type="date" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-train-end" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Training END Date</label>
                        <input id="emp-train-end" class="form-control" type="date" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <label id="lbl-status1" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Status1</label>
                            <span id="badge-status1" style="font-size:0.75rem; padding:1px 6px; border-radius:4px; font-weight:bold; display:none;"></span>
                        </div>
                        <input id="emp-status1" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-days-train" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Days Left - T.E.D.E</label>
                        <input id="emp-days-train" class="form-control" type="text" disabled style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-health" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Health card expired Date</label>
                        <input id="emp-health" class="form-control" type="date" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <label id="lbl-status2" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Status2</label>
                            <span id="badge-status2" style="font-size:0.75rem; padding:1px 6px; border-radius:4px; font-weight:bold; display:none;"></span>
                        </div>
                        <input id="emp-status2" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-days-health" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Days Left - Health card</label>
                        <input id="emp-days-health" class="form-control" type="text" disabled style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div style="grid-column: span 2;">
                        <label style="display:inline-flex; align-items:center; gap:8px; cursor:pointer; color:#b0bec5; font-size:0.8rem; margin-bottom:5px;">
                            <input type="checkbox" id="chk-health-img" style="width:14px; height:14px;">
                            <span>Upload Health Card Image (ุตูุฑุฉ ุงููุฑุช ุงูุตุญู)</span>
                        </label>
                        <div id="div-health-img" style="display:none; margin-top:5px;">
                            <input id="emp-health-file" type="file" accept="image/*" class="form-control" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px; font-size:0.8rem;">
                            <div id="view-health-img" style="margin-top:5px;"></div>
                        </div>
                    </div>

                    <!-- AIRPORT PERMIT CARD SECTION -->
                    <div style="grid-column: span 2; border-top: 1px solid #334155; margin: 10px 0; padding-top: 10px;">
                        <span style="color: #4facfe; font-size: 0.9rem; font-weight: bold;">Airport Permit Card (ูุฑุช ุชุตุฑูุญ ูุทุงุฑ)</span>
                    </div>
                    <div>
                        <label id="lbl-airport-permit-number" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Permit Number (ุฑูู ุงูุชุตุฑูุญ)</label>
                        <input id="emp-airport-permit-number" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-airport-permit-expiry" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Expiry Date (ุชุงุฑูุฎ ุงูุชูุงุก)</label>
                        <input id="emp-airport-permit-expiry" class="form-control" type="date" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <label id="lbl-airport-permit-status" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Status (ุงูุญุงูุฉ)</label>
                            <span id="badge-airport-permit-status" style="font-size:0.75rem; padding:1px 6px; border-radius:4px; font-weight:bold; display:none;"></span>
                        </div>
                        <input id="emp-airport-permit-status" class="form-control" type="text" placeholder="ูุนุงู, ูุดุท, ููููุฏ, ููุบู, ูุณูู" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-airport-permit-days" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Remaining Days (ุงูุงูุงู ุงููุชุจููุฉ)</label>
                        <input id="emp-airport-permit-days" class="form-control" type="text" disabled style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div style="grid-column: span 2;">
                        <label style="display:inline-flex; align-items:center; gap:8px; cursor:pointer; color:#b0bec5; font-size:0.8rem; margin-bottom:5px;">
                            <input type="checkbox" id="chk-airport-permit-img" style="width:14px; height:14px;">
                            <span>Upload Permit Image (ุตูุฑุฉ ูู ุงูุชุตุฑูุญ)</span>
                        </label>
                        <div id="div-airport-permit-img" style="display:none; margin-top:5px;">
                            <input id="emp-airport-permit-file" type="file" accept="image/*" class="form-control" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px; font-size:0.8rem;">
                            <div id="view-airport-permit-img" style="margin-top:5px;"></div>
                        </div>
                    </div>
                    <div>
                        <label id="lbl-city" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">city</label>
                        <input id="emp-city" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div>
                        <label id="lbl-region" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Region</label>
                        <input id="emp-region" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                    <div style="grid-column: span 2;">
                        <label id="lbl-remarks" style="display:block; color:#b0bec5; font-size:0.8rem; margin-bottom:2px;">Remarks</label>
                        <input id="emp-remarks" class="form-control" type="text" style="background:#0f172a; border:1px solid #334155; color:#fff; padding:4px 8px; height:32px;">
                    </div>
                </div>
                <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:15px;">
                    <button class="btn btn-secondary" id="btn-close-emp" style="padding:4px 12px; font-size:0.9rem;">ุฅูุบุงุก</button>
                    <button class="btn btn-primary" id="btn-save-emp" style="padding:4px 12px; font-size:0.9rem;">ุญูุธ</button>
                </div>
            </div>
        </div>
    </div>
    

    <!-- License Modal -->
    <div id="license-modal" style="position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.8); z-index:9999;">
        <div style="background:#1e293b; color:#fff; width:95%; max-width:800px; border-radius:16px; padding:25px; box-shadow:0 25px 50px rgba(0,0,0,0.5); max-height:90vh; overflow-y:auto;">
            <h2 style="margin-top:0; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:15px; margin-bottom:20px;">ุจูุงูุงุช ุงููุฑุน ูุงูุชุฑุงุฎูุต</h2>
            
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                <!-- Basic Info -->
                <div style="grid-column: span 2; display:grid; grid-template-columns:1fr 1fr 1fr; gap:15px;">
                    <div>
                        <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงุณู ุงููุฑุน</label>
                        <input id="lic-branch" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูููุทูุฉ</label>
                        <select id="lic-region" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            <option value="Western">Western</option>
                            <option value="Central">Central</option>
                            <option value="Eastern">Eastern</option>
                            <option value="Northern">Northern</option>
                            <option value="Southern">Southern</option>
                        </select>
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ</label>
                        <div style="display:flex; gap:5px;">
                            <select id="lic-brand" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; flex:1;">
                                <option value="BK">Burger King</option>
                                <option value="TC">Texas Chicken</option>
                                <option value="BWW">Buffalo Wild Wings</option>
                            </select>
                            <button type="button" onclick="addNewBrand()" class="btn btn-secondary" style="padding:0 10px; font-weight:bold; font-size:1.2rem;" title="ุฅุถุงูุฉ ุนูุงูุฉ ุชุฌุงุฑูุฉ">+</button>
                        </div>
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูููุฏ ุงูููุญุฏ (Unified Code)</label>
                        <input id="lic-unified-code" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                    </div>
                </div>

                <!-- Cost -->
                <div>
                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุชูููุฉ ุงูุชุดุบูููุฉ</label>
                    <input id="lic-cost" type="number" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                </div>

                <!-- Visibility -->
                <div style="display:flex; align-items:center; gap:10px; margin-top:25px;">
                    <label class="switch">
                        <input type="checkbox" id="lic-hidden">
                        <span class="slider round"></span>
                    </label>
                    <span>ุฅุฎูุงุก ุงููุฑุน ูู ุงูุนุฑุถ</span>
                </div>

                <!-- Divider -->
                <div style="grid-column: span 2; border-top:1px solid rgba(255,255,255,0.1); margin:10px 0;"></div>

                <!-- Store License -->
                <div>
                    <h4 style="color:#60a5fa; margin:0 0 10px 0;">ุฑุฎุตุฉ ุงูุจูุฏูุฉ</h4>
                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุฑูู ุงูุฑุฎุตุฉ</label>
                    <input id="lic-store-num" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                    
                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุญุงูุฉ</label>
                    <select id="lic-store-status" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                        <option value="Valid">Valid (ุณุงุฑู)</option>
                        <option value="Expired">Expired (ููุชูู)</option>
                        <option value="Near Expiration">Near Expiration (ูุฑุจ ุงูุงูุชูุงุก)</option>
                    </select>
                    
                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                    <input id="lic-store-date" type="date" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                    <div id="lic-store-days-left" style="font-size: 0.8rem; margin-top: -5px; margin-bottom: 10px; min-height: 20px;"></div>
                
                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุตูุฑุฉ ุงูุชุฑุฎูุต (PDF/Image)</label>
                    <input id="lic-store-file" type="file" accept="image/*,application/pdf" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                    <div id="lic-store-file-view" style="margin-bottom:10px;"></div>

                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ูู ุชูุฌุฏ ููุญุงุช ุนููุฏูุฉุ</label>
                    <select id="lic-has-vertical" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                        <option value="No">ูุง</option>
                        <option value="Yes">ูุนู</option>
                    </select>
                    
                    <div id="div-unipole-img" style="display:none;">
                        <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุตูุฑุฉ ุงููููููุจู (Unipole)</label>
                        <input id="lic-unipole-file" type="file" accept="image/*" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                    </div>
                </div>

                <!-- Civil Defense -->
                <div>
                    <h4 style="color:#f87171; margin:0 0 10px 0;">ุงูุฏูุงุน ุงููุฏูู</h4>
                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุฑูู ุงูุชุตุฑูุญ</label>
                    <input id="lic-civil-num" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">

                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุญุงูุฉ</label>
                    <select id="lic-civil-status" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                        <option value="Valid">Valid (ุณุงุฑู)</option>
                        <option value="Expired">Expired (ููุชูู)</option>
                        <option value="Near Expiration">Near Expiration (ูุฑุจ ุงูุงูุชูุงุก)</option>
                    </select>
                    
                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                    <input id="lic-civil-date" type="date" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                    <div id="lic-civil-days-left" style="font-size: 0.8rem; margin-top: 5px; margin-bottom: 10px; min-height: 20px;"></div>

                    <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุตูุฑุฉ ุงูุชุฑุฎูุต (PDF/Image)</label>
                    <input id="lic-civil-file" type="file" accept="image/*,application/pdf" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                    <div id="lic-civil-file-view" style="margin-bottom:10px;"></div>
                </div>

                <!-- Permits Section -->
                <div style="grid-column: span 2; display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                    
                    <!-- 24 Hours Permit -->
                    <div style="background:rgba(255,255,255,0.02); padding:15px; border-radius:8px; border:1px solid #334155;">
                        <h4 style="color:#60a5fa; margin:0 0 10px 0;">ุชุตุฑูุญ 24 ุณุงุนุฉ</h4>
                        <label style="display:inline-flex; align-items:center; gap:10px; cursor:pointer; color:#fff; margin-bottom:10px;">
                            <input type="checkbox" id="lic-p24-exist" style="width:18px; height:18px;">
                            <span>ููุฌุฏ ุชุตุฑูุญ</span>
                        </label>
                        
                        <div id="div-p24-details" style="display:none;">
                            <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุฑูู ุงูุชุตุฑูุญ</label>
                            <input id="lic-p24-num" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                            
                            <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                            <input id="lic-p24-date" type="date" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                            
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุชูููุฉ</label>
                                <input id="lic-p24-cost" type="number" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            </div>
                        </div>
                    </div>

                    <!-- Home Delivery Permit -->
                    <div style="background:rgba(255,255,255,0.02); padding:15px; border-radius:8px; border:1px solid #334155;">
                        <h4 style="color:#f472b6; margin:0 0 10px 0;">ุชุตุฑูุญ ุงูุชูุตูู</h4>
                        <label style="display:inline-flex; align-items:center; gap:10px; cursor:pointer; color:#fff; margin-bottom:10px;">
                            <input type="checkbox" id="lic-phd-exist" style="width:18px; height:18px;">
                            <span>ููุฌุฏ ุชุตุฑูุญ</span>
                        </label>
                        
                        <div id="div-phd-details" style="display:none;">
                            <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุฑูู ุงูุชุตุฑูุญ</label>
                            <input id="lic-phd-num" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                            
                            <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                            <input id="lic-phd-date" type="date" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                            <div id="lic-phd-days-left" style="font-size: 0.8rem; margin-top: -5px; margin-bottom: 10px; min-height: 20px;"></div>

                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุชูููุฉ</label>
                                <input id="lic-phd-cost" type="number" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            </div>
                        </div>
                    </div>

                    <!-- Outdoor Seating Permit -->
                    <div style="background:rgba(255,255,255,0.02); padding:15px; border-radius:8px; border:1px solid #334155; grid-column: span 2;">
                        <h4 style="color:#a78bfa; margin:0 0 10px 0;">ุชุตุฑูุญ ุงูุฌูุณุงุช ุงูุฎุงุฑุฌูุฉ</h4>
                        <label style="display:inline-flex; align-items:center; gap:10px; cursor:pointer; color:#fff; margin-bottom:10px;">
                            <input type="checkbox" id="lic-out-exist" style="width:18px; height:18px;">
                            <span>ููุฌุฏ ุชุตุฑูุญ</span>
                        </label>
                        
                        <div id="div-out-details" style="display:none; grid-template-columns: 1fr 1fr; gap:15px;">
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุฑูู ุงูุชุตุฑูุญ</label>
                                <input id="lic-out-num" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                                
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                                <input id="lic-out-date" type="date" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                                <div id="lic-out-days-left" style="font-size: 0.8rem; margin-top: 5px; margin-bottom: 10px; min-height: 20px;"></div>
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงููุณุงุญุฉ (ูยฒ)</label>
                                <input id="lic-out-area" type="number" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; margin-bottom:10px;">
                                
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุชูููุฉ</label>
                                <input id="lic-out-cost" type="number" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Advertising Permit -->
                <div style="grid-column: span 2;">
                    <h4 style="color:#fbbf24; margin:10px 0 10px 0;">ุงูุชุตุงุฑูุญ ุงูุฅุนูุงููุฉ</h4>
                    
                    <!-- List of existing permits -->
                    <div id="ads-permits-list" style="margin-bottom:15px; display:flex; flex-direction:column; gap:10px;">
                        <!-- Dynamic Content -->
                    </div>

                    <!-- Button to show add form -->
                    <button type="button" onclick="showAddPermitForm()" class="btn btn-secondary" style="width:100%; border:1px dashed #fbbf24; color:#fbbf24; padding: 10px;">
                        + ุฅุถุงูุฉ ุชุตุฑูุญ ุฅุนูุงูู ุฌุฏูุฏ
                    </button>

                    <!-- Add/Edit Permit Form (Hidden by default) -->
                    <div id="div-add-permit-form" style="display:none; margin-top:15px; border:1px solid #334155; padding:15px; border-radius:8px; background:rgba(255,255,255,0.02);">
                        <h5 style="margin-top:0; color:#cbd5e1; border-bottom: 1px solid #334155; padding-bottom: 10px;">ุชูุงุตูู ุงูุชุตุฑูุญ</h5>
                        <input type="hidden" id="new-ads-id"> <!-- For editing -->

                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:10px;">
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุฑูู ุงูุชุตุฑูุญ</label>
                                <input id="new-ads-num" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                                <input id="new-ads-date" type="date" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                                <div id="new-ads-days-left" style="font-size: 0.8rem; margin-top: 5px; margin-bottom: 10px; min-height: 20px;"></div>
                            </div>
                        </div>

                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:10px;">
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ูุฏุฉ ุงูุชุตุฑูุญ</label>
                                <select id="new-ads-duration" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                                    <option value="30">30 ููู</option>
                                    <option value="60">60 ููู</option>
                                    <option value="90">90 ููู</option>
                                    <option value="365">ุณูุฉ (365 ููู)</option>
                                    <option value="Other">ุฃุฎุฑู</option>
                                </select>
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุชูููุฉ (ุฑ.ุณ)</label>
                                <input id="new-ads-cost" type="number" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            </div>
                        </div>

                        <div style="margin-bottom:10px;">
                            <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุตูุฑุฉ ุงูููุตู / ุงูููุญุฉ</label>
                            <input id="new-ads-file" type="file" accept="image/*" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            <img id="new-ads-preview" src="" style="max-width:100%; height:auto; margin-top:10px; border-radius:8px; display:none; border:1px solid #334155;">
                        </div>

                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:15px;">
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุทูู (cm)</label>
                                <input id="new-ads-h" type="number" placeholder="ูุซุงู: 120" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงูุนุฑุถ (cm)</label>
                                <input id="new-ads-w" type="number" placeholder="ูุซุงู: 80" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff;">
                            </div>
                        </div>

                        <div style="display:flex; gap:10px;">
                            <button type="button" onclick="addPermitToList()" class="btn btn-primary" style="flex:1;">ุญูุธ ุงูุชุตุฑูุญ</button>
                            <button type="button" onclick="hideAddPermitForm()" class="btn btn-danger" style="flex:1;">ุฅูุบุงุก</button>
                        </div>
                    </div>
                </div>

            </div>

            <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:15px; border-top:1px solid rgba(255,255,255,0.1); padding-top:15px;">
                <button onclick="document.getElementById('license-modal').style.display='none'" class="btn btn-secondary" style="padding:6px 15px;">ุฅูุบุงุก</button>
                <button onclick="saveLicense()" class="btn btn-primary" style="padding:6px 15px;">ุญูุธ ุงูุจูุงูุงุช</button>
            </div>
        </div>
    </div>

    <!-- Brand Modal -->
    <div id="brand-modal" style="position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.8); z-index:10000;">
        <div style="background:#1e293b; color:#fff; width:90%; max-width:400px; border-radius:12px; padding:20px; box-shadow:0 10px 25px rgba(0,0,0,0.5);">
            <h3 style="margin-top:0; color:#fbbf24; margin-bottom:15px;">ุฅุถุงูุฉ ุนูุงูุฉ ุชุฌุงุฑูุฉ ุฌุฏูุฏุฉ</h3>
            <label style="display:block; margin-bottom:5px; color:#94a3b8;">ุงุณู ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ</label>
            <input id="new-brand-name" type="text" class="form-control" style="background:#0f172a; border-color:#334155; color:#fff; width:100%; margin-bottom:20px;" placeholder="ุฃุฏุฎู ุงูุงุณู ููุง...">
            <div style="display:flex; justify-content:flex-end; gap:10px;">
                <button onclick="document.getElementById('brand-modal').style.display='none'" class="btn btn-secondary">ุฅูุบุงุก</button>
                <button onclick="saveNewBrand()" class="btn btn-primary">ุญูุธ</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs (Compat version for easier integration) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    
    <!-- Config File -->
    <script src="firebase-config.js"></script>
    
    <!-- Enhanced License Management -->
    <script src="license-enhanced.js"></script>
    
    <!-- Main Script -->
    <script src="admin.js"></script>
</body>
</html>
